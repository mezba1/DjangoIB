{% extends 'root/base.html' %}

{% load humanize %}
{% load static %}

{% block head_staticfiles %}
    <link href="{% static 'boards/css/slug.css' %}" rel="stylesheet" />
{% endblock %}

{% block content %}
<div id="root">
    {% include 'boards/board_links.html' %}

    {% include 'boards/board_info.html' %}

    {% include 'boards/thread_form.html' %}

    {% include "boards/slug_menu.html" %}

    {% include "boards/slug_paginator.html" with pclass="bb" %}

    <div class="threads-container">
        {% if thread_count > 0 %}
            {% for t in threads %}
                <div class="clearfix thread-container">
                    <div class="post-container op">
                        <div class="image-info">File: <a href="{{ t.get_image_download_url }}" target="_blank">{{ t.file_name }}</a> ({{ t.file_size|filesizeformat }}, {{ t.file_width }}x{{ t.file_height }}) </div>
                        <div class="post-image-container">
                            <a class="post-image-link" href="{{ t.get_image_download_url }}" data-full-src="{{ t.get_image_url }}" data-thumb-src="{{ t.get_thumbnail }}">
                                <img class="post-image" src="{{ t.get_thumbnail }}" alt="Post image" />
                            </a>
                        </div>
                        <div>
                            <span class="post-id">#{{ t.pk }}</span>
                            {% if t.title %}<span><b>{{ t.title }}</b></span>&nbsp;{% endif %}
                            {% if t.name %}<span class="poster-name">{{ t.name }}</span>{% else %}<span class="poster-name anon">Anonymous</span>{% endif %}&nbsp;
                            <span title="{{ t.created_at|naturaltime }}">{{ t.created_at }}</span>
                            <span>[ <a href="{{ t.get_absolute_url }}">Reply</a> ]</span>
                            {% if t.quoted_in_set.exists %}
                            (<span class="text-disabled">Quoted in:</span>
                            {% for pq in t.quoted_in_set.all %}<a class="quoted-post-to-link" href="#p{{ pq.pk }}">&gt;&gt;{{ pq.pk }}</a>{% endfor %})
                            {% endif %}
                        </div>
                        <div class="post-body">{{ t.body | safe }}</div>
                        {% if t.ctx.expandable %}
                            <div class="expandable-info">
                                {{ t.ctx.hidden_reply_count }} repl{% if t.ctx.hidden_reply_count > 1 %}ies{% else %}y{% endif %}{% if t.ctx.hidden_reply_with_image_count %} including {{ t.ctx.hidden_reply_with_image_count }} image{% if t.ctx.hidden_reply_with_image_count > 1 %}s{% endif %}{% endif %} hidden. View full thread <a href="{{ t.get_absolute_url }}">here</a>.
                            </div>
                        {% endif %}
                    </div>
                    {% if t.ctx.reply_count %}
                        {% for p in t.ctx.replies %}
                            {% include "boards/reply.html" %}
                        {% endfor %}
                    {% else %}
                        <h4>No replies yet!</h4>
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <h4>No threads yet!</h4>
        {% endif %}
    </div>

    {% include "boards/slug_paginator.html" with pclass="bt" %}

    {% include "boards/slug_menu.html" with bottom=True %}

    <div class="fluke"></div>
    {% include 'boards/board_links.html' %}

    {% include "boards/footer.html" %}
</div>
{% endblock %}

{% block body_scripts %}
    <script src="{% static 'boards/js/b.js' %}" type="text/javascript"></script>
{% endblock %}
